---
# defaults file for ./roles/ssh

ssh_package_dependencies:
  - openssh-server

# ------------------------------------------------------------------------------
ssh_directory: /etc/ssh
ssh_directory_home: ~/.ssh

# ------------------------------------------------------------------------------
ssh_short_moduli: 3071
ssh_service_enabled: yes # start on boot

# ------------------------------------------------------------------------------
# template sshd_config.config.j2
ssh_port: 22

ssh_kex_algorithms: "curve25519-sha256@libssh.org,ecdh-sha2-nistp521,ecdh-sha2-nistp384,ecdh-sha2-nistp256,diffie-hellman-group-exchange-sha256"
ssh_ciphers: "chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr"
ssh_macs: "hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-512,hmac-sha2-256,umac-128@openssh.com"

ssh_authentication_methods: publickey
ssh_permit_root_login: "no"
ssh_use_privilege_separation: sandbox
ssh_challenge_response_authentication: "no"
ssh_use_PAM: "yes"
ssh_x11_forwarding: "yes"
ssh_print_motd: "no"
ssh_use_dns: "no"
ssh_accept_env: "LANG LC_*"
ssh_subsystem: "sftp  /usr/lib/ssh/sftp-server -f AUTHPRIV -l INFO"

# ------------------------------------------------------------------------------
# template config.config.j2 (installed per user in ~/.ssh)
ssh_hash_known_hosts: "yes"
ssh_host_key_algorithms: >
  "ssh-ed25519-cert-v01@openssh.com,ssh-rsa-cert-v01@openssh.com,ssh-ed25519,ssh-rsa,ecdsa-sha2-nistp521-cert-v01@openssh.com,ecdsa-sha2-nistp384-cert-v01@openssh.com,ecdsa-sha2-nistp256-cert-v01@openssh.com,ecdsa-sha2-nistp521,ecdsa-sha2-nistp384,ecdsa-sha2-nistp256"

ssh_user_kex_algorithms: "{{ ssh_kex_algorithms }}"
ssh_user_macs: "{{ ssh_macs }}"
ssh_user_ciphers: "{{ ssh_ciphers }}"
